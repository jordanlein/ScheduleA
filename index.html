<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Schedule A Phenomenon: An Interactive Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Material You Expressive (Lavender, Teal, Magenta) -->
    <!-- Application Structure Plan: The SPA has been refactored into a simulated multi-page application. A central JavaScript router function clears the main content area and dynamically injects the HTML for the selected "page." This provides a cleaner user flow, prevents an overwhelmingly long single page, and makes each section feel distinct and focused. The structure remains a narrative journey, but the presentation is now paginated for better usability and a more modern feel. -->
    <!-- Visualization & Content Choices: 
        - All original choices retained. The primary change is in the UI/UX presentation layer.
        - UI/UX Rationale: The new design uses a Material You "Expressive" theme. This involves a soft lavender background, high-contrast text, vibrant teal and magenta accents, and heavily rounded shapes (`rounded-2xl`, `rounded-full`). This creates a more engaging, modern, and "app-like" feel, making the dense legal information more approachable for a non-expert audience without trivializing it. Page transitions are animated with a subtle fade-in to enhance the multi-page experience.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        :root {
            --bg-primary: #f5f3ff; /* Light Lavender */
            --surface-container: #ffffff;
            --text-primary: #1f2937;
            --text-secondary: #4b5563;
            --accent-primary: #0d9488; /* Teal */
            --accent-secondary: #c026d3; /* Magenta */
            --border-color: #e5e7eb;
            --sidebar-width: 280px;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
        }
        .main-content {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .nav-link.active {
            background-color: var(--bg-primary);
            color: var(--accent-primary);
            font-weight: 600;
        }
        .nav-link.active svg {
            color: var(--accent-primary);
        }
        .loader {
            border: 4px solid #e0e7ff;
            border-top: 4px solid var(--accent-primary);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #bot-modal {
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        #bot-modal-content {
            transition: transform 0.3s ease;
        }
        .tab-button.active {
            background-color: white;
            color: var(--accent-primary);
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        .sidebar {
            transition: transform 0.3s ease-in-out;
        }
        .timeline-item.active .timeline-dot {
            background-color: var(--accent-secondary);
            transform: scale(1.25);
        }
        .timeline-item.active .timeline-content {
            border-color: var(--accent-secondary);
        }

        @media (min-width: 1024px) {
            .main-container {
                padding-left: var(--sidebar-width);
            }
        }

        .legal-term {
            color: var(--accent-secondary);
            cursor: pointer;
            position: relative;
            font-weight: 600;
            text-decoration: underline dotted;
        }

        #legal-tooltip {
            position: absolute;
            display: none;
            width: 300px;
            background-color: var(--surface-container);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 12px;
            z-index: 100;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-size: 0.9rem;
            line-height: 1.4;
        }
    </style>
</head>
<body class="antialiased">

    <div id="legal-tooltip"></div>

    <div class="relative min-h-screen lg:flex">
        <!-- Sidebar -->
        <aside id="sidebar" class="bg-white text-gray-800 w-[var(--sidebar-width)] fixed inset-y-0 right-0 transform translate-x-full lg:left-0 lg:translate-x-0 z-40 lg:z-auto sidebar lg:flex flex-col">
            <div class="p-6 text-center border-b">
                <h1 class="text-2xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-teal-500 to-fuchsia-600">Schedule A</h1>
                <p class="text-sm text-text-secondary">An Analysis</p>
            </div>
            <nav id="main-nav" class="flex-1 p-4 space-y-2">
                <a href="#home" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    Home
                </a>
                <a href="#playbook" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg>
                    The Playbook
                </a>
                <a href="#epicenter" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                    The Epicenter
                </a>
                <a href="#controversy" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    The Controversy
                </a>
                <a href="#big-picture" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2h10a2 2 0 002-2v-1a2 2 0 012-2h1.945M7.737 11l-.262-2.812a1 1 0 01.99-1.138h7.07a1 1 0 01.99 1.138L16.263 11M12 16v4m-4-4v4m8-4v4"></path></svg>
                    The Big Picture
                </a>
                <a href="#forward" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    The Path Forward
                </a>
                <a href="#toolkit" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                     <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                    Defendant's Toolkit
                </a>
                <a href="#resources" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3h3m-3 3h3m-3 3h3"></path></svg>
                    Resources & News
                </a>
                <a href="#caselaw" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    Case Law Database
                </a>
                <a href="#casestudies" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    Case Studies
                </a>
                <a href="#plaintiffs-perspective" class="nav-link flex items-center px-4 py-2.5 text-text-secondary rounded-lg hover:bg-gray-100">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                    The Plaintiff's Perspective
                </a>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <div class="main-container flex-1">
            <!-- Mobile Header -->
            <header class="lg:hidden sticky top-0 bg-f5f3ff/80 backdrop-blur-md z-30 flex items-center justify-between p-4 border-b">
                <h1 class="text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-teal-500 to-fuchsia-600">Schedule A</h1>
                <button id="hamburger-button" class="p-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
            </header>
            
            <main id="main-content-area" class="p-6 lg:p-10">
                <!-- Dynamic content will be injected here -->
            </main>
        </div>
    </div>

    <!-- Floating Action Button for Bot -->
    <button id="open-bot-button" class="fixed bottom-8 right-8 bg-gradient-to-br from-teal-500 to-fuchsia-600 text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center transform hover:scale-110 transition-transform duration-200 z-40">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.828 8.828 0 01-4.32-1.146L2.26 17.65A1 1 0 012 17v-3.333A6.975 6.975 0 011 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM4.667 12.667A5.002 5.002 0 009 15c2.757 0 5-1.79 5-4s-2.243-4-5-4-5 1.79-5 4a4.983 4.983 0 001.667 3.667z" clip-rule="evenodd" />
        </svg>
    </button>

    <!-- Bot Modal -->
    <div id="bot-modal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4 z-50 invisible opacity-0">
        <div id="bot-modal-content" class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl p-6 transform scale-95 relative">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-text-primary">‚ú® Ask a Legal Bot</h2>
                <button id="close-bot-button" class="text-gray-400 hover:bg-gray-200 rounded-full p-1 focus:outline-none focus:ring-2 focus:ring-gray-400">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <p class="mt-2 mb-4 text-text-secondary">Ask our AI assistant about Schedule A lawsuits. It will first use the information from this report, then search for external context if needed.</p>
            <div class="space-y-4">
                <div><label for="qa-input" class="block text-sm font-medium text-text-primary">Your Question:</label><input type="text" id="qa-input" class="mt-1 block w-full rounded-full border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm px-4 py-2" placeholder="e.g., What is a TRO?"></div>
                <button id="qa-button" class="inline-flex items-center px-6 py-2 border border-transparent text-sm font-medium rounded-full shadow-sm text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all">Ask Gemini</button>
            </div>
            <div id="qa-response-area" class="mt-6">
                <div id="qa-loader" class="hidden justify-center items-center py-4"><div class="loader"></div></div>
                <div id="qa-answer" class="p-4 bg-f5f3ff rounded-xl border border-gray-200 hidden"></div>
                <div id="qa-error" class="p-4 bg-red-50 text-red-700 rounded-xl border border-red-200 hidden"></div>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const legalGlossary = {
                'ex parte': 'A legal proceeding brought by one person in the absence of and without representation or notification of other parties.',
                'joinder': 'The joining of two or more legal issues together. In the context of Schedule A cases, it refers to suing multiple defendants in a single lawsuit.',
                'Temporary Restraining Order (TRO)': 'A short-term, pre-trial temporary injunction granted by a court on an ex parte basis.',
                'due process': 'A fundamental principle of fairness in all legal matters, both civil and criminal, especially in the courts.',
                'jurisdiction': 'The official power to make legal decisions and judgments.',
                'Schedule A': 'A confidential list of defendants in a lawsuit, used in mass IP litigation to sue many online sellers at once without publicly naming them initially.'
            };

            const mainContentArea = document.getElementById('main-content-area');
            const navContainer = document.getElementById('main-nav');
            const sidebar = document.getElementById('sidebar');
            const hamburgerButton = document.getElementById('hamburger-button');
            
            const pageTemplates = {
                home: `
                    <section id="home" class="main-content space-y-8">
                        <div class="max-w-4xl mx-auto text-center">
                             <h2 class="text-3xl lg:text-4xl font-bold text-text-primary">An Interactive Analysis of Mass IP Litigation</h2>
                             <p class="mt-4 text-lg text-text-secondary">This interactive report explores the world of "Schedule A" lawsuits‚Äîa powerful and controversial legal strategy used to combat online counterfeiting. Discover the step-by-step process, understand the controversy, see the data, and explore the path forward. Choose a section below to begin.</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 text-left">
                            <a href="#playbook" class="nav-card block bg-surface-container p-6 rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                                <h3 class="text-xl font-bold text-text-primary mb-2">The Playbook</h3>
                                <p class="text-text-secondary">Learn the step-by-step anatomy of a Schedule A lawsuit, from the secret filing to the asset freeze.</p>
                            </a>
                            <a href="#epicenter" class="nav-card block bg-surface-container p-6 rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                                <h3 class="text-xl font-bold text-text-primary mb-2">The Epicenter</h3>
                                <p class="text-text-secondary">Why has Chicago's federal court become the undisputed ground zero for this type of litigation?</p>
                            </a>
                            <a href="#controversy" class="nav-card block bg-surface-container p-6 rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                                <h3 class="text-xl font-bold text-text-primary mb-2">The Controversy</h3>
                                <p class="text-text-secondary">Explore the deep conflicts with due process, procedural rules, and fairness.</p>
                            </a>
                            <a href="#big-picture" class="nav-card block bg-surface-container p-6 rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                                <h3 class="text-xl font-bold text-text-primary mb-2">The Big Picture</h3>
                                <p class="text-text-secondary">Understand the massive economic stakes and the signals these cases send about our legal system.</p>
                            </a>
                            <a href="#forward" class="nav-card block bg-surface-container p-6 rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                                <h3 class="text-xl font-bold text-text-primary mb-2">The Path Forward</h3>
                                <p class="text-text-secondary">Discover the judicial, legislative, and technological solutions that could reform online IP enforcement.</p>
                            </a>
                             <a href="#toolkit" class="nav-card block bg-surface-container p-6 rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                                <h3 class="text-xl font-bold text-text-primary mb-2">Defendant's Toolkit</h3>
                                <p class="text-text-secondary">A step-by-step checklist for those who find themselves named in a Schedule A lawsuit.</p>
                            </a>
                            <a href="#resources" class="nav-card block bg-surface-container p-6 rounded-2xl shadow-lg hover:shadow-xl hover:-translate-y-1 transition-all duration-300">
                                <h3 class="text-xl font-bold text-text-primary mb-2">Resources & News</h3>
                                <p class="text-text-secondary">Find links for further reading and a live feed of the latest news on Schedule A cases.</p>
                            </a>
                        </div>
                    </section>
                `,
                playbook: `
                    <section id="playbook" class="main-content space-y-12">
                        <div class="text-center max-w-3xl mx-auto">
                            <h2 class="text-3xl font-bold text-text-primary">Anatomy of a Schedule A Lawsuit</h2>
                            <p class="mt-4 text-text-secondary">Schedule A cases are a unique legal strategy used by brands to sue hundreds of online sellers at once. This interactive timeline breaks down the highly effective, step-by-step process they use.</p>
                        </div>
                        <div class="relative wrap overflow-hidden p-10 h-full">
                            <div class="border-2-2 absolute border-opacity-20 border-gray-700 h-full border" style="left: 50%"></div>
                            <!-- Timeline items -->
                            <div id="timeline-container" class="space-y-8"></div>
                        </div>
                        <div id="step-details" class="max-w-3xl mx-auto p-6 bg-surface-container rounded-2xl shadow-lg min-h-[150px]"></div>
                    </section>
                `,
                epicenter: `
                    <section id="epicenter" class="main-content space-y-8">
                        <div class="text-center max-w-3xl mx-auto"><h2 class="text-3xl font-bold text-text-primary">Ground Zero: The Northern District of Illinois</h2><p class="mt-4 text-text-secondary">One federal court in Chicago has become the undisputed hub for Schedule A litigation. A combination of judicial receptiveness and streamlined procedures has created a favorable "market" for this type of lawsuit. The chart below visualizes this staggering concentration.</p></div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                             <div class="bg-surface-container p-4 sm:p-6 rounded-2xl shadow-lg">
                                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2970.483489475763!2d-87.63555568455895!3d41.88219597922219!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880e2cb8f4ba65cf%3A0x89295569990bb943!2sEverett%20McKinley%20Dirksen%20United%20States%20Courthouse!5e0!3m2!1sen!2sus!4v1690129876543!5m2!1sen!2sus" width="100%" height="350" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" class="rounded-lg"></iframe>
                            </div>
                            <div class="bg-surface-container p-4 sm:p-6 rounded-2xl shadow-lg"><div class="chart-container" style="height: 350px; max-height: 40vh; max-width: 700px; margin: auto;"><canvas id="ndilChart"></canvas></div></div>
                        </div>
                    </section>
                `,
                controversy: `
                    <section id="controversy" class="main-content space-y-8">
                        <div class="text-center max-w-3xl mx-auto"><h2 class="text-3xl font-bold text-text-primary">A Collision with Due Process</h2><p class="mt-4 text-text-secondary">The power and efficiency of the Schedule A model come at a cost, creating a direct conflict with core principles of the American legal system. This section explores the key points of contention.</p></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg"><h3 class="text-xl font-bold text-text-primary mb-3">‚öñÔ∏è Due Process & Notice</h3><p class="text-text-secondary">The bedrock of constitutional due process is the right to receive notice and have a meaningful opportunity to be heard. Schedule A cases systematically subvert this by using *ex parte* Temporary Restraining Orders (TROs) to freeze assets and shut down businesses before defendants are even aware a lawsuit exists. This preemptive penalty, executed without the defendant's participation, is seen by critics as a "sneak up" attack that departs from expected standards of fairness.</p></div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg"><h3 class="text-xl font-bold text-text-primary mb-3">üîó Improper Joinder</h3><p class="text-text-secondary">Federal rules generally require that defendants in a single lawsuit be connected by the "same transaction or occurrence." Schedule A cases challenge this by lumping together hundreds of independent sellers who often have no connection other than being accused of infringing the same trademark. While plaintiffs argue this is a practical response to a "swarm" of counterfeiters, judges are increasingly ruling that this practice improperly stretches the rule to save plaintiffs massive filing fees.</p></div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg"><h3 class="text-xl font-bold text-text-primary mb-3">üèõÔ∏è The Jurisdictional Paradox</h3><p class="text-text-secondary">Courts in Chicago have found they have jurisdiction over foreign sellers who offer to ship products to Illinois. However, in a striking paradox, when those same sellers try to sue the rights holder in Chicago, the court has often found it *lacks* jurisdiction over the U.S. company. This creates a one-way street to the courthouse, where the legal principles of "minimum contacts" appear to be applied asymmetrically, favoring the rights holder over the foreign merchant.</p></div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg"><h3 class="text-xl font-bold text-text-primary mb-3">‚öñÔ∏è Power Imbalance</h3><p class="text-text-secondary">These cases pit some of the world's largest corporations against small, often foreign, merchants who may lack English proficiency or an understanding of the U.S. legal system. The immediate asset freeze is particularly debilitating, as it deprives defendants of the very funds they would need to hire a lawyer and fight the case. This dynamic creates immense pressure to settle quickly, regardless of the merits of the plaintiff's claims.</p></div>
                        </div>
                    </section>
                `,
                'big-picture': `
                    <section id="big-picture" class="main-content space-y-8">
                        <div class="text-center max-w-3xl mx-auto"><h2 class="text-3xl font-bold text-text-primary">Systemic Signals & Economic Stakes</h2><p class="mt-4 text-text-secondary">Schedule A lawsuits are a symptom of larger forces: a legal system struggling with a borderless internet and the staggering economic scale of global counterfeiting.</p></div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg"><h3 class="text-xl font-bold text-text-primary mb-3">üí∞ The Counterfeiting Economy</h3><p class="text-text-secondary mb-4">The aggressive tactics are a direct reaction to a massive underground industry that drains hundreds of billions from the legitimate economy. Beyond lost revenue, brands suffer from reputational erosion and must expend enormous resources on enforcement, diverting capital from innovation. The anonymity and global reach of e-commerce platforms have acted as a powerful accelerant for this problem.</p><div class="space-y-2 text-text-primary"><p><span class="font-bold text-2xl text-fuchsia-600" data-count="467">0</span><span class="font-bold text-2xl text-fuchsia-600"> Billion:</span> Value of international counterfeit trade.</p><p><span class="font-bold text-2xl text-fuchsia-600" data-count="5.4">0</span><span class="font-bold text-2xl text-fuchsia-600"> Million:</span> Jobs lost globally.</p><p><span class="font-bold text-2xl text-fuchsia-600" data-count="4.2">0</span><span class="font-bold text-2xl text-fuchsia-600"> Trillion:</span> Projected total value by 2025.</p></div></div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg"><h3 class="text-xl font-bold text-text-primary mb-3">üåê A Stressed Legal System</h3><p class="text-text-secondary">The traditional one-plaintiff-versus-one-defendant model is ill-equipped for the high-volume, anonymous nature of online infringement. This creates a dilemma: rigidly following rules designed for a pre-internet era makes enforcement nearly impossible, but bending those rules creates a due process crisis. Schedule A litigation exists in this gray area, highlighting a global struggle to apply national laws to a borderless digital world.</p></div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg lg:col-span-1 md:col-span-2"><h3 class="text-xl font-bold text-text-primary mb-3">üõí The Role of Platforms</h3><p class="text-text-secondary">The battleground for IP enforcement has shifted to online marketplaces like Amazon and Etsy. A powerful movement seeks to shift the enforcement burden onto these multi-billion-dollar corporations, arguing they profit from the environment that allows counterfeiting to thrive. Proposed laws like the SHOP SAFE Act would move platforms from the role of passive hosts to active, accountable gatekeepers responsible for verifying sellers and screening for fakes.</p></div>
                        </div>
                    </section>
                `,
                forward: `
                    <section id="forward" class="main-content space-y-8">
                        <div class="text-center max-w-3xl mx-auto"><h2 class="text-3xl font-bold text-text-primary">The Path Forward</h2><p class="mt-4 text-text-secondary">The Schedule A model is at a crossroads. The future will likely involve a mix of judicial, legislative, and technological solutions.</p></div>
                        <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                            <div class="flex justify-center mb-6 p-1 bg-gray-200/70 rounded-full"><div id="tab-container" class="flex gap-2">
                                <button data-tab="judicial" class="tab-button px-4 py-2 text-sm font-semibold rounded-full transition-colors duration-200">Judicial Reform</button>
                                <button data-tab="legislative" class="tab-button px-4 py-2 text-sm font-semibold rounded-full transition-colors duration-200">Legislative Action</button>
                                <button data-tab="technological" class="tab-button px-4 py-2 text-sm font-semibold rounded-full transition-colors duration-200">Technological Solutions</button>
                            </div></div>
                            <div id="tab-content" class="min-h-[250px]"></div>
                        </div>
                        <div class="mt-12 max-w-3xl mx-auto bg-surface-container p-6 rounded-2xl shadow-lg">
                            <h3 class="text-2xl font-bold text-text-primary mb-4">‚ú® Generate a Sample Cease & Desist Letter</h3>
                            <p class="text-text-secondary mb-4">For educational purposes, see how a legal notice might be structured. <strong class="text-red-600">This is not legal advice.</strong></p>
                            <div class="space-y-4">
                                <div><label for="brand-name" class="block text-sm font-medium text-text-primary">Your Brand Name:</label><input type="text" id="brand-name" class="mt-1 block w-full rounded-full border-gray-300 shadow-sm px-4 py-2" placeholder="e.g., Acme Widgets"></div>
                                <div><label for="product-type" class="block text-sm font-medium text-text-primary">Infringing Product Type:</label><input type="text" id="product-type" class="mt-1 block w-full rounded-full border-gray-300 shadow-sm px-4 py-2" placeholder="e.g., Counterfeit blue widgets"></div>
                                <div><label for="seller-name" class="block text-sm font-medium text-text-primary">Seller's Online Store Name:</label><input type="text" id="seller-name" class="mt-1 block w-full rounded-full border-gray-300 shadow-sm px-4 py-2" placeholder="e.g., BestWidgetDeals"></div>
                                <button id="generate-letter-button" class="inline-flex items-center px-6 py-2 border border-transparent text-sm font-medium rounded-full shadow-sm text-white bg-gradient-to-r from-teal-500 to-teal-600 hover:from-teal-600 hover:to-teal-700">Generate with Gemini</button>
                            </div>
                            <div id="letter-response-area" class="mt-6"><div id="letter-loader" class="hidden justify-center items-center py-4"><div class="loader"></div></div><div id="letter-output" class="hidden"><textarea readonly class="w-full h-64 p-4 border border-gray-300 rounded-2xl bg-f5f3ff font-mono text-sm"></textarea><button id="copy-letter-button" class="mt-2 px-4 py-2 border border-transparent text-sm font-medium rounded-full text-white bg-gray-600 hover:bg-gray-700">Copy Text</button></div><div id="letter-error" class="p-4 bg-red-50 text-red-700 rounded-xl border border-red-200 hidden"></div></div>
                        </div>
                    </section>
                `,
                toolkit: `
                    <section id="toolkit" class="main-content space-y-8">
                        <div class="text-center max-w-3xl mx-auto">
                            <h2 class="text-3xl font-bold text-text-primary">Defendant's Toolkit</h2>
                            <p class="mt-4 text-text-secondary">Finding yourself named in a Schedule A lawsuit can be overwhelming. This checklist provides a simplified guide for your first steps. <strong class="text-red-600">This is for informational purposes only and is not legal advice.</strong></p>
                        </div>
                        <div class="space-y-6 max-w-4xl mx-auto">
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                                <h3 class="text-xl font-bold text-text-primary mb-2">Step 1: Don't Panic. Understand What Happened.</h3>
                                <p class="text-text-secondary">Your funds have likely been frozen by a Temporary Restraining Order (TRO). This is a standard part of the Schedule A process. It is not a final judgment of guilt. The goal is to understand the situation calmly and act methodically.</p>
                            </div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                                <h3 class="text-xl font-bold text-text-primary mb-2">Step 2: Identify the Case and Plaintiff.</h3>
                                <p class="text-text-secondary">The notice you received from your e-commerce platform (like Amazon or PayPal) should contain a case number and the court where it was filed (likely the Northern District of Illinois). Use this information to look up the case on PACER (Public Access to Court Electronic Records) to see the actual complaint and find out who is suing you.</p>
                            </div>
                             <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                                <h3 class="text-xl font-bold text-text-primary mb-2">Step 3: Preserve All Records.</h3>
                                <p class="text-text-secondary">Do not delete any emails, sales records, communications with suppliers, or product listings. Your business records are crucial evidence, whether you decide to fight the case or negotiate a settlement. Preserving this information is a critical first step.</p>
                            </div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                                <h3 class="text-xl font-bold text-text-primary mb-2">Step 4: Assess Your Options (Realistically).</h3>
                                <p class="text-text-secondary">You generally have three paths: <strong>Fight</strong> the case in court, which is very expensive and time-consuming. <strong>Settle</strong> with the plaintiff, which usually involves forfeiting a portion of your frozen funds in exchange for being dismissed from the lawsuit. Or, do nothing and receive a <strong>Default Judgment</strong>, where you will likely lose all the frozen funds. Your decision will depend on your resources and the strength of your case.</p>
                            </div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                                <h3 class="text-xl font-bold text-text-primary mb-2">Step 5: Seek Experienced Legal Counsel Immediately.</h3>
                                <p class="text-text-secondary">This is the most critical step. Do not try to navigate this alone. You need a lawyer who specifically has experience with Schedule A trademark cases. General practice lawyers may not understand the unique procedures and pressures of this litigation. A specialized attorney can help you understand your rights, assess the plaintiff's claims, and negotiate the best possible outcome.</p>
                            </div>
                        </div>
                    </section>
                `,
                resources: `
                    <section id="resources" class="main-content space-y-12">
                        <div class="text-center max-w-3xl mx-auto"><h2 class="text-3xl font-bold text-text-primary">Resources & News</h2><p class="mt-4 text-text-secondary">Explore reliable sources for deeper analysis and stay updated with the latest news on Schedule A litigation.</p></div>
                        
                        <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                            <h3 class="text-2xl font-bold text-text-primary mb-4">Further Reading</h3>
                            <ul class="space-y-3 list-disc list-inside text-text-secondary">
                                <li><a href="https://drive.google.com/file/d/16mPF6Rv74hAshXiR7YaQnpSaAKQDjqeB/view?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-teal-600 hover:underline"><strong>Read the Full Report:</strong> Access the complete PDF this interactive site is based on.</a></li>
                                <li><a href="https://columbialawreview.org/" target="_blank" rel="noopener noreferrer" class="text-teal-600 hover:underline"><strong>Columbia Law Review:</strong> For in-depth academic analysis of the procedural and constitutional issues.</a></li>
                                <li><a href="https://www.ilnd.uscourts.gov/" target="_blank" rel="noopener noreferrer" class="text-teal-600 hover:underline"><strong>Northern District of Illinois Court Website:</strong> Access to court dockets, standing orders, and judicial opinions.</a></li>
                                <li><a href="https://www.pacer.gov/" target="_blank" rel="noopener noreferrer" class="text-teal-600 hover:underline"><strong>PACER (Public Access to Court Electronic Records):</strong> The official federal judiciary system for accessing case and docket information.</a></li>
                                <li><a href="https://www.schwimmerlegal.com/" target="_blank" rel="noopener noreferrer" class="text-teal-600 hover:underline"><strong>The Trademark Blog:</strong> Legal commentary and updates on trademark law and litigation trends.</a></li>
                            </ul>
                        </div>

                        <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                             <h3 class="text-2xl font-bold text-text-primary mb-4">Latest Newsfeed</h3>
                             <div id="news-feed-container" class="space-y-4">
                                <!-- News will be injected here -->
                                <div class="text-center p-4"><div class="loader inline-block"></div></div>
                             </div>
                        </div>
                    </section>
                `,
                caselaw: `
                    <section id="caselaw" class="main-content space-y-8">
                        <div class="text-center max-w-3xl mx-auto">
                            <h2 class="text-3xl font-bold text-text-primary">Case Law Database</h2>
                            <p class="mt-4 text-text-secondary">An interactive database of notable Schedule A cases. Search, sort, and explore key rulings and documents.</p>
                        </div>
                        <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                            <div class="mb-4">
                                <input type="text" id="case-search" class="block w-full rounded-full border-gray-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm px-4 py-2" placeholder="Search by case name, judge, or summary...">
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Case Name</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer" data-sort="judge">Presiding Judge</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider cursor-pointer" data-sort="date">Date Filed</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Summary of Ruling</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-text-secondary uppercase tracking-wider">Link to Docket</th>
                                        </tr>
                                    </thead>
                                    <tbody id="case-table-body" class="bg-white divide-y divide-gray-200">
                                        <!-- Case data will be injected here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>
                `,
                casestudies: `
                    <section id="casestudies" class="main-content space-y-12">
                        <div class="text-center max-w-3xl mx-auto">
                            <h2 class="text-3xl font-bold text-text-primary">Case Studies in Schedule A Litigation</h2>
                            <p class="mt-4 text-text-secondary">These narrative case studies explore how Schedule A lawsuits unfold in the real world, illustrating the profound impact on both plaintiffs and defendants.</p>
                        </div>

                        <!-- Case Study 1 -->
                        <div class="bg-surface-container p-6 lg:p-8 rounded-2xl shadow-lg space-y-6">
                            <h3 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-teal-500 to-fuchsia-600">The Case of the Counterfeit Handbags</h3>

                            <div>
                                <h4 class="text-xl font-semibold text-text-primary mb-2">The Plaintiff</h4>
                                <p class="text-text-secondary">A globally recognized luxury fashion house, "Chic & Co.", known for its iconic leather handbags that retail for thousands of dollars. The company invests heavily in brand protection and has a zero-tolerance policy for counterfeits.</p>
                            </div>

                            <div>
                                <h4 class="text-xl font-semibold text-text-primary mb-2">The Defendants</h4>
                                <p class="text-text-secondary">A list of 250+ online storefronts, operating on various e-commerce platforms. The sellers are mostly anonymous, based in China, and use transient, quickly-abandoned online identities. They sell convincing-looking knockoffs for a fraction of the authentic price.</p>
                            </div>

                            <div>
                                <h4 class="text-xl font-semibold text-text-primary mb-2">The Ruling</h4>
                                <blockquote class="border-l-4 border-accent-secondary pl-4 py-2 my-4 bg-gray-50 italic">
                                    <p class="text-text-secondary">"The Court finds that the plaintiff has made a sufficient showing that, without an immediate restraining order, the defendants would likely continue their infringing activities and dissipate or hide their assets, causing irreparable harm to the plaintiff's brand. The public interest in protecting intellectual property rights weighs in favor of granting the temporary relief sought."</p>
                                    <cite class="mt-2 block text-right text-sm text-gray-500">- Fictional Excerpt from a TRO Ruling</cite>
                                </blockquote>
                            </div>

                            <div>
                                <h4 class="text-xl font-semibold text-text-primary mb-2">The Impact</h4>
                                <p class="text-text-secondary">The *ex parte* TRO successfully freezes the PayPal and merchant accounts of the targeted sellers, immediately halting their operations. Most defendants, lacking the resources to hire U.S. counsel, default. The plaintiff recovers a portion of the frozen funds and disrupts a significant counterfeit network, albeit temporarily. The case reinforces the effectiveness of the Schedule A model for rights holders.</p>
                            </div>

                            <div class="bg-teal-50 border-l-4 border-teal-500 p-4 rounded-r-lg mt-6">
                                <h5 class="font-bold text-teal-800">Key Takeaway</h5>
                                <p class="text-teal-700">For large brands facing widespread, anonymous online counterfeiting, Schedule A lawsuits offer a powerful and efficient tool to disrupt sales and recover damages, bypassing the need to litigate against each seller individually.</p>
                            </div>
                        </div>

                        <!-- Case Study 2 -->
                        <div class="bg-surface-container p-6 lg:p-8 rounded-2xl shadow-lg space-y-6">
                            <h3 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-teal-500 to-fuchsia-600">The Case of the Mistakenly Accused Artist</h3>

                            <div>
                                <h4 class="text-xl font-semibold text-text-primary mb-2">The Plaintiff</h4>
                                <p class="text-text-secondary">A major media corporation that owns the rights to a popular animated character. They employ a law firm that files dozens of Schedule A cases a year, using automated tools to find allegedly infringing products.</p>
                            </div>

                            <div>
                                <h4 class="text-xl font-semibold text-text-primary mb-2">The Defendants</h4>
                                <p class="text-text-secondary">A Schedule A list of over 400 online stores. Buried in this list is "Artisan Crafts," a small, independent online shop run by a single artist in Spain who sells original, hand-painted custom sneakers. One of her designs was mistakenly flagged by the plaintiff's automated search as infringing.</p>
                            </div>

                            <div>
                                <h4 class="text-xl font-semibold text-text-primary mb-2">The Ruling</h4>
                                 <blockquote class="border-l-4 border-accent-secondary pl-4 py-2 my-4 bg-gray-50 italic">
                                    <p class="text-text-secondary">"Upon review, it has come to the Court's attention that the joinder of these disparate defendants... stretches the bounds of Federal Rule of Civil Procedure 20. The Court is not convinced that the actions of an independent artist in Spain and a mass-producer of counterfeits in China constitute the 'same transaction or occurrence.' The Court orders the plaintiff to show cause why this case should not be dismissed for improper joinder."</p>
                                    <cite class="mt-2 block text-right text-sm text-gray-500">- Fictional Excerpt from a Court Order</cite>
                                </blockquote>
                            </div>

                            <div>
                                <h4 class="text-xl font-semibold text-text-primary mb-2">The Impact</h4>
                                <p class="text-text-secondary">The artist's entire business account is frozen, including funds from legitimate sales, causing immense personal and financial distress. Unable to afford a U.S. lawyer, she contacts a legal aid society, which helps her file a declaration with the court. The judge, seeing the potential for injustice, begins to scrutinize the plaintiff's broad claims, highlighting the due process concerns inherent in the Schedule A model.</p>
                            </div>

                            <div class="bg-fuchsia-50 border-l-4 border-fuchsia-500 p-4 rounded-r-lg mt-6">
                                <h5 class="font-bold text-fuchsia-800">Key Takeaway</h5>
                                <p class="text-fuchsia-700">The "dragnet" approach of Schedule A lawsuits can inadvertently ensnare legitimate small businesses. The lack of individual scrutiny before an asset freeze poses significant due process risks and can cause severe harm to innocent defendants.</p>
                            </div>
                        </div>

                    </section>
                `,
                'plaintiffs-perspective': `
                    <section id="plaintiffs-perspective" class="main-content space-y-8">
                        <div class="text-center max-w-3xl mx-auto">
                            <h2 class="text-3xl font-bold text-text-primary">The Plaintiff's Perspective</h2>
                            <p class="mt-4 text-text-secondary">To understand the Schedule A phenomenon, it's crucial to view it from the perspective of the brand owners (plaintiffs) who use it. For them, this legal tool is not about targeting small sellers but about surviving a tidal wave of anonymous, industrial-scale counterfeiting that threatens their brands, their customers, and their very existence. This section explores their rationale.</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                                <h3 class="text-xl font-bold text-text-primary mb-3">Protecting Brand Integrity and Reputation</h3>
                                <p class="text-text-secondary">Placeholder paragraph explaining that a brand's value is built on years of trust, quality, and marketing. Counterfeits, often of poor quality, dilute this hard-won reputation. When consumers receive a shoddy product they believe is genuine, they lose faith in the brand, causing long-term damage that is difficult to quantify but immensely significant. From this viewpoint, aggressive, large-scale enforcement is a necessary defensive measure to protect a core business asset.</p>
                            </div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                                <h3 class="text-xl font-bold text-text-primary mb-3">Ensuring Consumer Safety from Counterfeit Goods</h3>
                                <p class="text-text-secondary">Placeholder paragraph detailing the dangers of counterfeit products. This goes beyond luxury goods; fake cosmetics can contain harmful chemicals, counterfeit electronics can pose fire hazards, and fake toys can be made with toxic materials. Plaintiffs argue they have a responsibility to protect consumers from these dangers. By removing counterfeit listings en masse, they see themselves as performing a critical public safety function that platforms are failing to manage effectively.</p>
                            </div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                                <h3 class="text-xl font-bold text-text-primary mb-3">The Inefficiency of Traditional Enforcement</h3>
                                <p class="text-text-secondary">Placeholder paragraph describing why traditional, one-by-one lawsuits are utterly ineffective in the digital age. Filing a single lawsuit against a single seller is slow and expensive. By the time it's resolved, the seller has vanished and reappeared under a new name, while hundreds more have taken their place. The Schedule A model is a direct response to this reality, providing a scalable solution that, while imperfect, is one of the few legal mechanisms that can operate at the speed and scale of the problem.</p>
                            </div>
                            <div class="bg-surface-container p-6 rounded-2xl shadow-lg">
                                <h3 class="text-xl font-bold text-text-primary mb-3">Combating Anonymous, High-Volume Sellers</h3>
                                <p class="text-text-secondary">Placeholder paragraph focusing on the nature of the adversary. Plaintiffs contend they are not suing small, independent artisans. Rather, they are targeting sophisticated, often interconnected networks of sellers who are experts at exploiting the anonymity of the internet. These sellers operate hundreds of stores under different names, making it impossible to identify and serve them individually. The *ex parte* TRO and asset freeze are presented as the only effective means to unmask these operators and disrupt their cash flow.</p>
                            </div>
                        </div>
                    </section>
                `
            };
            
            const stepDetailsContent = {
                'step-1': { title: 'Step 1: The Sealed Complaint', text: 'The rights holder (plaintiff) files a lawsuit against dozens or hundreds of online stores. Instead of listing them publicly, the defendants\' names are hidden in a confidential "Schedule A" document. The plaintiff argues this secrecy is necessary to prevent sellers from destroying evidence or moving money once they know they are being sued.' },
                'step-2': { title: 'Step 2: The *Ex Parte* TRO', text: 'Immediately, the plaintiff asks the judge for a Temporary Restraining Order (TRO) in an *ex parte* hearing. This means the defendants are not present or notified. The judge only hears the plaintiff\'s side of the story. Given the one-sided presentation, these requests are very often granted.' },
                'step-3': { title: 'Step 3: Asset Freeze & Takedown', text: 'The granted TRO is a powerful weapon. The plaintiff\'s lawyers serve it on third parties like Amazon, Etsy, PayPal, and eBay. The order commands them to immediately freeze all funds in the defendants\' accounts and deactivate their online storefronts and product listings.' },
                'step-4': { title: 'Step 4: The Defendant\'s "Notice"', text: 'For most sellers, the first time they learn of the lawsuit is when their business is suddenly paralyzed. Their store vanishes, their listings are gone, and their entire revenue stream is frozen. This creates immediate and severe financial distress, leaving them confused and blindsided.' },
                'step-5': { title: 'Step 5: The Path to Resolution', text: 'With their business crippled, defendants are under immense pressure. They have three options: 1) <strong>Settle:</strong> Pay the plaintiff a portion of the frozen funds to get their account back. 2) <strong>Default:</strong> Do nothing, often due to lack of resources or understanding, allowing the plaintiff to take all frozen funds. 3) <strong>Fight:</strong> A rare and expensive option, especially since their operating capital is frozen.' }
            };
            const tabContentData = {
                judicial: { title: 'Judicial Reform: Fixing the System from Within', points: ['<strong>Apply Stricter Joinder Rules:</strong> Judges can enforce existing federal rules more stringently, requiring plaintiffs to demonstrate a concrete transactional link between defendants beyond simply being accused of similar infringement. This would likely result in smaller, more manageable lawsuits and reduce the risk of improperly targeting unrelated businesses.', '<strong>Raise the Bar for TROs:</strong> Courts could demand a higher standard of evidence before granting *ex parte* orders that freeze assets. This might include requiring more than just screenshots and demanding proof that the defendant is likely to destroy evidence or flee, thereby reserving such a powerful tool for the most clear-cut cases of bad-faith actors.', '<strong>Mandate Due Diligence:</strong> Judges could issue standing orders requiring plaintiffs to certify that they have conducted thorough pre-filing investigations. This would place the onus on rights holders to ensure they are not sweeping legitimate businesses into their mass lawsuits, with the threat of sanctions for failing to do so.'] },
                legislative: { title: 'Legislative Action: Changing the Rules of the Game', points: ['<strong>Pass Platform Accountability Laws:</strong> Congress could enact laws like the SHOP SAFE Act, which would hold e-commerce platforms contributorily liable for infringement unless they adopt a set of "best practices." This would fundamentally shift the enforcement burden from rights holders to the multi-billion-dollar platforms that facilitate the sales.', '<strong>Mandate Seller Verification:</strong> Legislation like the INFORM Consumers Act already requires platforms to collect and verify the identity and contact information of high-volume third-party sellers. Strengthening and expanding these requirements would reduce the anonymity that allows counterfeiters to operate with impunity.', '<strong>Proactive Policing Requirements:</strong> Future laws could move beyond verification and obligate platforms to proactively screen for and remove counterfeit listings using their own technological resources, rather than relying on a reactive notice-and-takedown system.'] },
                technological: { title: 'Technological Solutions: Enforcement by Design', points: ['<strong>AI & Machine Learning:</strong> Advanced AI can scan millions of product listings, images, and seller profiles in real-time. By analyzing patterns, logos, and pricing anomalies, these systems can automatically flag and remove suspected counterfeits at a scale and speed that human enforcement could never achieve.', '<strong>Blockchain for Supply Chains:</strong> Creating a secure "digital passport" for a product on a blockchain can provide an immutable record of its journey from the factory to the consumer. This allows anyone in the supply chain, including customs officials and end consumers, to instantly verify an item\'s authenticity with a simple scan, making it much harder for fakes to enter the market.', '<strong>Automated Takedown Networks:</strong> Rather than playing "whack-a-mole" with individual listings, smarter systems can identify and analyze the connections between fraudulent sellers. By mapping these networks, platforms can disable entire clusters of bad actors at once, a far more effective strategy than addressing them one by one.'] }
            };

            function renderPage(pageId) {
                mainContentArea.innerHTML = pageTemplates[pageId] || `<p>Page not found.</p>`;
                switch(pageId) {
                    case 'home':
                        // Add event listeners to the new nav cards on the home page
                        mainContentArea.querySelectorAll('.nav-card').forEach(card => {
                            card.addEventListener('click', (e) => {
                                e.preventDefault();
                                const targetId = card.getAttribute('href').substring(1);
                                renderPage(targetId);
                                window.history.pushState({pageId: targetId}, '', `#${targetId}`);
                            });
                        });
                        break;
                    case 'playbook': initPlaybook(); break;
                    case 'epicenter': initEpicenterChart(); break;
                    case 'big-picture': initBigPictureCounters(); break;
                    case 'forward': initForward(); break;
                    case 'resources': initResourcesAndNews(); break;
                    case 'caselaw': initCaseLawDatabase(); break;
                    case 'casestudies': break; // No special init needed for this simple template
                }
                updateActiveNav(pageId);
                highlightLegalTerms();
            }

            function updateActiveNav(pageId) {
                navContainer.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href') === `#${pageId}`);
                });
            }

            navContainer.addEventListener('click', (e) => {
                 e.preventDefault();
                const link = e.target.closest('a');
                if (link) {
                    const pageId = link.getAttribute('href').substring(1);
                    renderPage(pageId);
                    window.history.pushState({pageId}, '', `#${pageId}`);
                    // Close sidebar on mobile after navigation
                    if (window.innerWidth < 1024) {
                        sidebar.classList.add('translate-x-full');
                        sidebar.classList.remove('translate-x-0');
                    }
                }
            });
            
            window.addEventListener('popstate', (e) => {
                const pageId = e.state ? e.state.pageId : 'home';
                renderPage(pageId);
            });

            hamburgerButton.addEventListener('click', () => {
                sidebar.classList.toggle('-translate-x-full');
                 sidebar.classList.toggle('translate-x-0');
            });

            function highlightLegalTerms() {
                const contentArea = document.getElementById('main-content-area');
                if (!contentArea) return;

                const tooltip = document.getElementById('legal-tooltip');
                const allTextNodes = [];

                function getTextNodes(node) {
                    if (node.nodeType === 3) {
                        allTextNodes.push(node);
                    } else {
                        for (let i = 0; i < node.childNodes.length; i++) {
                            getTextNodes(node.childNodes[i]);
                        }
                    }
                }

                getTextNodes(contentArea);

                const termKeys = Object.keys(legalGlossary).sort((a, b) => b.length - a.length);

                allTextNodes.forEach(textNode => {
                    if (textNode.parentElement.tagName === 'SCRIPT' || textNode.parentElement.tagName === 'STYLE') {
                        return;
                    }
                    let originalText = textNode.nodeValue;
                    let newHtml = originalText;

                    termKeys.forEach(term => {
                        const regex = new RegExp(`\\b(${term})\\b`, 'gi');
                        newHtml = newHtml.replace(regex, `<span class="legal-term" data-term="${term}">$1</span>`);
                    });

                    if (newHtml !== originalText) {
                        const newFragment = document.createRange().createContextualFragment(newHtml);
                        textNode.parentElement.replaceChild(newFragment, textNode);
                    }
                });

                contentArea.addEventListener('mouseover', function(e) {
                    if (e.target.classList.contains('legal-term')) {
                        const term = e.target.dataset.term;
                        tooltip.innerHTML = `<strong>${term}</strong>: ${legalGlossary[term]}`;
                        tooltip.style.display = 'block';

                        const rect = e.target.getBoundingClientRect();
                        let top = rect.bottom + window.scrollY + 5;
                        let left = rect.left + window.scrollX;

                        if (top + tooltip.offsetHeight > window.innerHeight + window.scrollY) {
                            top = rect.top + window.scrollY - tooltip.offsetHeight - 5;
                        }
                        if (left + tooltip.offsetWidth > window.innerWidth + window.scrollX) {
                            left = window.innerWidth + window.scrollX - tooltip.offsetWidth - 10;
                        }

                        tooltip.style.top = `${top}px`;
                        tooltip.style.left = `${left}px`;
                    }
                });

                contentArea.addEventListener('mouseout', function(e) {
                    if (e.target.classList.contains('legal-term')) {
                        tooltip.style.display = 'none';
                    }
                });
            }

            function initCaseLawDatabase() {
                const caseData = [
                    {
                        name: 'The General Automobile Insurance Company, Inc. v. Schedule A...',
                        judge: 'John F. Kness',
                        date: '2023-05-18',
                        summary: 'Order to stay all proceedings and reassess the validity of using Schedule A in such cases.',
                        docket: 'https://www.pacer.gov/'
                    },
                    {
                        name: 'Louis Vuitton Malletier v. Schedule A...',
                        judge: 'LaShonda A. Hunt',
                        date: '2022-11-09',
                        summary: 'Granted ex parte TRO, freezing assets of hundreds of online sellers.',
                        docket: 'https://www.pacer.gov/'
                    },
                    {
                        name: 'Nike, Inc. v. Schedule A...',
                        judge: 'Mary M. Rowland',
                        date: '2023-01-22',
                        summary: 'Denied motion for TRO due to improper joinder of unrelated defendants.',
                        docket: 'https://www.pacer.gov/'
                    },
                    {
                        name: 'Gucci America, Inc. v. Schedule A...',
                        judge: 'Edmond E. Chang',
                        date: '2021-08-30',
                        summary: 'Issued a default judgment against defendants who failed to appear.',
                        docket: 'https://www.pacer.gov/'
                    },
                    {
                        name: 'Apple Inc. v. Schedule A...',
                        judge: 'Thomas M. Durkin',
                        date: '2023-03-15',
                        summary: 'Dismissed case for lack of personal jurisdiction over foreign defendants.',
                        docket: 'https://www.pacer.gov/'
                    }
                ];

                const tableBody = document.getElementById('case-table-body');
                const searchInput = document.getElementById('case-search');
                const headers = document.querySelectorAll('[data-sort]');
                let currentSort = { key: 'date', direction: 'desc' };

                function renderTable(data) {
                    tableBody.innerHTML = '';
                    data.forEach(item => {
                        const row = `
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-text-primary">${item.name}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-text-secondary">${item.judge}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-text-secondary">${new Date(item.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</td>
                                <td class="px-6 py-4 text-sm text-text-secondary">${item.summary}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-teal-600 hover:underline"><a href="${item.docket}" target="_blank" rel="noopener noreferrer">View Docket</a></td>
                            </tr>
                        `;
                        tableBody.innerHTML += row;
                    });
                }

                function sortData(data, key, direction) {
                    return [...data].sort((a, b) => {
                        if (a[key] < b[key]) return direction === 'asc' ? -1 : 1;
                        if (a[key] > b[key]) return direction === 'asc' ? 1 : -1;
                        return 0;
                    });
                }

                function filterData(data, query) {
                    const lowerCaseQuery = query.toLowerCase();
                    return data.filter(item => {
                        return Object.values(item).some(value =>
                            String(value).toLowerCase().includes(lowerCaseQuery)
                        );
                    });
                }

                function updateTable() {
                    const query = searchInput.value;
                    const filtered = filterData(caseData, query);
                    const sorted = sortData(filtered, currentSort.key, currentSort.direction);
                    renderTable(sorted);
                }

                searchInput.addEventListener('input', updateTable);

                headers.forEach(header => {
                    header.addEventListener('click', () => {
                        const key = header.dataset.sort;
                        const direction = currentSort.key === key && currentSort.direction === 'asc' ? 'desc' : 'asc';
                        currentSort = { key, direction };
                        updateTable();
                    });
                });

                updateTable();
            }

            function initPlaybook() {
                const timelineContainer = document.getElementById('timeline-container');
                const stepDetailsContainer = document.getElementById('step-details');
                
                Object.keys(stepDetailsContent).forEach((key, index) => {
                    const step = stepDetailsContent[key];
                    const alignment = index % 2 === 0 ? 'flex-row-reverse' : '';
                    const timelineItem = `
                        <div class="mb-8 flex justify-between items-center w-full ${alignment}">
                            <div class="order-1 w-5/12"></div>
                            <div class="z-20 flex items-center order-1 bg-gray-800 shadow-xl w-8 h-8 rounded-full">
                                <h1 class="mx-auto font-semibold text-lg text-white">${index + 1}</h1>
                            </div>
                            <div class="order-1 bg-white rounded-lg shadow-xl w-5/12 px-6 py-4 timeline-item cursor-pointer" data-step="${key}">
                                <h3 class="font-bold text-gray-800 text-lg">${step.title.split(': ')[1]}</h3>
                            </div>
                        </div>
                    `;
                    timelineContainer.innerHTML += timelineItem;
                });

                function updateStepDetails(stepId) {
                    const content = stepDetailsContent[stepId];
                    if (content) {
                        stepDetailsContainer.innerHTML = `<h3 class="text-2xl font-bold text-text-primary mb-4">${content.title}</h3><p class="text-text-secondary leading-relaxed">${content.text}</p>`;
                    }
                    document.querySelectorAll('.timeline-item').forEach(item => {
                        item.classList.toggle('active', item.dataset.step === stepId);
                    });
                }

                timelineContainer.addEventListener('click', (e) => {
                    const targetItem = e.target.closest('.timeline-item');
                    if (targetItem) {
                        updateStepDetails(targetItem.dataset.step);
                    }
                });

                updateStepDetails('step-1');
            }

            function initEpicenterChart() {
                const ctx = document.getElementById('ndilChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: { labels: ['2020', '2021', '2022'], datasets: [{ label: 'Cases Filed in NDIL', data: [496, 664, 823], backgroundColor: 'rgba(13, 148, 136, 0.6)', borderColor: 'rgba(13, 148, 136, 1)', borderWidth: 2, borderRadius: 8 }, { label: 'Cases Filed Elsewhere', data: [37, 69, 112], backgroundColor: 'rgba(192, 38, 211, 0.6)', borderColor: 'rgba(192, 38, 211, 1)', borderWidth: 2, borderRadius: 8 }] },
                    options: { responsive: true, maintainAspectRatio: false, plugins: { title: { display: true, text: 'Schedule A Case Filings: NDIL vs. Rest of U.S.', font: { size: 18 }, color: '#333' }, tooltip: { callbacks: { footer: (items) => { const total = items.reduce((s, i) => s + i.raw, 0); const ndil = items.find(i => i.dataset.label.includes('NDIL'))?.raw || 0; return total > 0 ? `NDIL handled ${((ndil / total) * 100).toFixed(1)}% of cases.` : ''; } } } }, scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true, title: { display: true, text: 'Number of Cases Filed' } } } }
                });
            }

            function initBigPictureCounters() {
                const counters = document.querySelectorAll('[data-count]');
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const counter = entry.target;
                            const target = +counter.dataset.count;
                            const duration = 1500;
                            const stepTime = 20;
                            let start = 0;
                            const step = (target * stepTime) / duration;
                            
                            const timer = setInterval(() => {
                                start += step;
                                if (start >= target) {
                                    clearInterval(timer);
                                    counter.innerText = target.toLocaleString();
                                } else {
                                    counter.innerText = Math.ceil(start).toLocaleString();
                                }
                            }, stepTime);
                            observer.unobserve(counter);
                        }
                    });
                }, { threshold: 0.7 });

                counters.forEach(counter => {
                    observer.observe(counter);
                });
            }
            
            function initForward() {
                const tabContainer = document.getElementById('tab-container');
                const tabContentContainer = document.getElementById('tab-content');
                
                function updateTabContent(activeButton) {
                    const tabId = activeButton.dataset.tab;
                    const content = tabContentData[tabId];
                    if (content) {
                        tabContentContainer.innerHTML = `<h3 class="text-2xl font-bold text-text-primary mb-4">${content.title}</h3><ul class="space-y-3 list-disc list-inside text-text-secondary">${content.points.map(p => `<li>${p}</li>`).join('')}</ul>`;
                    }
                    
                    tabContainer.querySelectorAll('.tab-button').forEach(button => {
                        button.classList.remove('active');
                    });
                    activeButton.classList.add('active');
                }

                tabContainer.addEventListener('click', (e) => {
                    if (e.target.classList.contains('tab-button')) {
                        updateTabContent(e.target);
                    }
                });
                
                updateTabContent(tabContainer.querySelector('.tab-button'));
                initGeminiLetter();
            }

            function formatDate(dateString) {
                if (!dateString) return 'Date not available';
                try {
                    const cleanDateString = dateString.includes(',') ? dateString.substring(dateString.indexOf(',') + 1).trim() : dateString;
                    const dateObj = new Date(cleanDateString);
                    if (isNaN(dateObj.getTime())) {
                        return 'Date not available';
                    }
                    return dateObj.toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                } catch (e) {
                    return 'Date not available';
                }
            }

            function initResourcesAndNews() {
                const newsContainer = document.getElementById('news-feed-container');
                const newsData = [
                    {"index": "1.2", "publication_time": "41 days ago, Wednesday, June 11, 2025 at 2:00:00 AM", "snippet": "ND Illinois Judge stays all his Schedule A trademark suits to ‚Äúreassess‚Äù By Marty Schwimmer on June 11, 2025. Posted in Uncategorized. Approximately 80% of Schedule A Defendant (‚ÄúSAD‚Äù) counterfeiting suits are brought in the Northern District of Illinois... Over the past few weeks a judge in the ND Ill, Judge John Kness, has issued an order staying all of his pending SAD suits...", "source_title": "ND Illinois Judge stays all his Schedule A trademark suits to \"reassess\"", "url": "https://www.schwimmerlegal.com/2025/06/nd-illinois-judge-stays-all-his-schedule-a-trademark-suits-to-reassess.html"},
                    {"index": "1.3", "publication_time": null, "snippet": "The Northern District of Illinois (‚ÄúNDIL‚Äù) has been a hotbed for ‚ÄúSchedule A‚Äù litigation... NDIL Judge John Kness, however, recently stayed dozens of Schedule A cases while the court considers whether Schedule A litigation is an appropriate procedure and an exercise of sound judicial discretion. He joins other NDIL judges who sua sponte have dismissed cases for improper joinder...", "source_title": "NDIL Hits Pause: ‚ÄúSchedule A‚Äù Suits Face New Scrutiny - Irwin IP", "url": "https://irwinip.com/2025/06/ndil-hits-pause-schedule-a-suits-face-new-scrutiny/"},
                    {"index": "1.4", "publication_time": null, "snippet": "Over the last five or more years, the Northern District has become the epicenter of intellectual property cases filed against an anonymous list of alleged infringers... 83% of the Schedule A cases filed have been filed in Chicago since 2020... But more recently, Judge Kness has stayed proceedings in over 50 Schedule A cases.", "source_title": "Roadblock or a Speedbump for Schedule A/Doe Case in the Northern District of Illinois?", "url": "https://www.chicagoiplitigation.com/2025/06/roadblock-or-a-speedbump-for-schedule-a-doe-case-in-the-northern-district-of-illinois/"},
                    {"index": "1.5", "publication_time": "482 days ago, Wednesday, March 27, 2024 at 2:00:00 AM", "snippet": "A cursory glance at the daily calendar in the Northern District of Illinois reveals a recurring theme: ‚ÄúSchedule A‚Äù cases. Such matters are prevalent in the district court judges' court calls. In fact, the Northern District of Illinois is by far the most popular court for filing Schedule A patent infringement cases.", "source_title": "The Slew of Schedule A Cases in the Northern District of Illinois", "url": "https://appellatelawgroup.com/the-slew-of-schedule-a-cases-in-the-northern-district-of-illinois/"}
                ];
                
                newsContainer.innerHTML = ''; // Clear loader
                if (newsData.length > 0) {
                    newsData.forEach(item => {
                        const displayDate = formatDate(item.publication_time);
                        const card = `
                            <div class="border border-gray-200 p-4 rounded-xl hover:shadow-md transition-shadow">
                                <p class="text-sm text-gray-500 mb-1">${displayDate}</p>
                                <h4 class="font-bold text-lg text-text-primary">${item.source_title}</h4>
                                <p class="text-text-secondary text-sm mt-2">${item.snippet.substring(0, 200)}...</p>
                                <a href="${item.url}" target="_blank" rel="noopener noreferrer" class="text-teal-600 hover:text-teal-700 font-semibold text-sm mt-3 inline-block">Read More &rarr;</a>
                            </div>
                        `;
                        newsContainer.innerHTML += card;
                    });
                } else {
                    newsContainer.innerHTML = '<p class="text-text-secondary">Could not fetch recent news. Please try again later.</p>';
                }
            }

            // --- GEMINI API INTEGRATION ---
            // IMPORTANT: To use this on your own website, you must get your own API key from Google AI Studio
            // and replace the empty string below.
            const userApiKey = "AIzaSyCEWu_dLqV5aFcqx2ffGRYpwyIiCmE82hI"; // <--- PASTE YOUR API KEY HERE

            const apiKey = typeof __initial_auth_token !== 'undefined' ? "" : userApiKey;
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            function initGeminiQA() {
                const qaButton = document.getElementById('qa-button');
                const qaInput = document.getElementById('qa-input');
                const qaLoader = document.getElementById('qa-loader');
                const qaAnswerDiv = document.getElementById('qa-answer');
                const qaErrorDiv = document.getElementById('qa-error');

                qaButton.addEventListener('click', async () => {
                    const question = qaInput.value.trim();
                    if (!question) return;

                    qaLoader.style.display = 'flex';
                    qaAnswerDiv.classList.add('hidden');
                    qaErrorDiv.classList.add('hidden');

                    const internalContext = Array.from(document.querySelectorAll('section')).map(s => s.innerText).join('\n\n');
                    const prompt = `You are an expert legal analyst. A user is asking a question about Schedule A lawsuits. First, try to answer the question using ONLY the provided internal context. If the answer is in the context, state that your answer is based on the report. If the context does not fully answer the question, you may use your own external knowledge to provide a more complete answer, but you MUST state that you are using external information. The user is not a lawyer, so keep the answer clear and easy to understand.

Internal Context from the report:
---
${internalContext}
---

User Question: "${question}"`;
                    
                    try {
                        const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                        const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                        const result = await response.json();
                        
                        if (result.candidates && result.candidates.length > 0) {
                            qaAnswerDiv.innerText = result.candidates[0].content.parts[0].text;
                            qaAnswerDiv.classList.remove('hidden');
                        } else { 
                            let errorMsg = 'No valid response from API.';
                            if (result.error) {
                                errorMsg += ` Details: ${result.error.message}`;
                            }
                            if (!apiKey && !userApiKey) {
                                errorMsg = "API key is missing. Please add your API key to the script to enable this feature.";
                            }
                            throw new Error(errorMsg);
                        }
                    } catch (error) {
                        qaErrorDiv.innerText = `Sorry, an error occurred. ${error.message}`;
                        qaErrorDiv.classList.remove('hidden');
                    } finally {
                        qaLoader.style.display = 'none';
                    }
                });
            }

            function initGeminiLetter() {
                const generateBtn = document.getElementById('generate-letter-button');
                const loader = document.getElementById('letter-loader');
                const outputDiv = document.getElementById('letter-output');
                const textarea = outputDiv.querySelector('textarea');
                const errorDiv = document.getElementById('letter-error');
                const copyBtn = document.getElementById('copy-letter-button');

                generateBtn.addEventListener('click', async () => {
                    const brandName = document.getElementById('brand-name').value.trim();
                    const productType = document.getElementById('product-type').value.trim();
                    const sellerName = document.getElementById('seller-name').value.trim();

                    if (!brandName || !productType || !sellerName) { alert('Please fill in all fields.'); return; }

                    loader.style.display = 'flex';
                    outputDiv.classList.add('hidden');
                    errorDiv.classList.add('hidden');

                    const prompt = `You are a legal writing assistant. For educational purposes, generate a simple, sample cease-and-desist letter regarding trademark infringement. The tone should be formal but clear for a non-lawyer. Do not include any real law firm names or contact information; use placeholders.\n\nInformation to use:\n- Brand Name: "${brandName}"\n- Allegedly Infringing Product: "${productType}"\n- Addressed to Seller Name: "${sellerName}"\n\nThe letter should include placeholders like [DATE], [YOUR NAME/FIRM], and [YOUR ADDRESS]. Crucially, end the letter with the disclaimer: "This letter is for educational purposes only and does not constitute legal advice."`;

                    try {
                        const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                        const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0) {
                            textarea.value = result.candidates[0].content.parts[0].text;
                            outputDiv.classList.remove('hidden');
                        } else { 
                             let errorMsg = 'No valid response from API.';
                            if (result.error) {
                                errorMsg += ` Details: ${result.error.message}`;
                            }
                             if (!apiKey && !userApiKey) {
                                errorMsg = "API key is missing. Please add your API key to the script to enable this feature.";
                            }
                            throw new Error(errorMsg);
                        }
                    } catch (error) {
                        errorDiv.innerText = `Sorry, an error occurred. ${error.message}`;
                        errorDiv.classList.remove('hidden');
                    } finally {
                        loader.style.display = 'none';
                    }
                });

                copyBtn.addEventListener('click', () => {
                    textarea.select();
                    document.execCommand('copy');
                    copyBtn.innerText = 'Copied!';
                    setTimeout(() => { copyBtn.innerText = 'Copy Text'; }, 2000);
                });
            }
            
            // --- BOT MODAL LOGIC ---
            const botModal = document.getElementById('bot-modal');
            const botModalContent = document.getElementById('bot-modal-content');
            const openBotButton = document.getElementById('open-bot-button');
            const closeBotButton = document.getElementById('close-bot-button');

            function openModal() {
                botModal.classList.remove('invisible', 'opacity-0');
                botModalContent.classList.remove('scale-95');
            }

            function closeModal() {
                botModal.classList.add('opacity-0');
                botModalContent.classList.add('scale-95');
                setTimeout(() => {
                    botModal.classList.add('invisible');
                }, 300);
            }

            openBotButton.addEventListener('click', openModal);
            closeBotButton.addEventListener('click', closeModal);
            botModal.addEventListener('click', (e) => {
                if (e.target === botModal) {
                    closeModal();
                }
            });
            window.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !botModal.classList.contains('invisible')) {
                    closeModal();
                }
            });


            // --- INITIAL LOAD ---
            const initialPage = window.location.hash.substring(1) || 'home';
            renderPage(initialPage);
            initGeminiQA(); // Initialize bot logic once on page load
        });
    </script>
</body>
</html>
